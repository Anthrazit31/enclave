<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Phoenix Industries Terminal</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <style>
    :root {
      --primary: #00ff00;
      --secondary: #003300;
      --accent: #00cc00;
      --error: #ff3333;
      --bg: #000;
      --text: #00ff00;
      --transition: all 0.3s ease;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Share Tech Mono', monospace;
      background: var(--bg);
      color: var(--text);
      height: 100vh;
      overflow: hidden;
      position: relative;
    }
    
    /* CRT Effect */
    .crt-effect::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        linear-gradient(rgba(0, 255, 0, 0.03) 50%, rgba(0, 0, 0, 0.1) 50%),
        linear-gradient(90deg, rgba(0, 255, 0, 0.03), rgba(0, 255, 0, 0.02), rgba(0, 255, 0, 0.03));
      background-size: 100% 3px, 3px 100%;
      pointer-events: none;
      z-index: 100;
    }
    
    .crt-effect::after {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.1);
      opacity: 0.1;
      pointer-events: none;
      z-index: 100;
      animation: flicker 0.15s infinite;
    }
    
    @keyframes flicker {
      0%, 100% { opacity: 0.1; }
      50% { opacity: 0.05; }
    }
    
    /* Entry Animation */
    .entry-animation {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg);
      color: var(--primary);
      font-size: clamp(1.5rem, 5vw, 3rem);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 1;
      transition: opacity 2s ease;
    }
    
    .entry-animation.fade-out {
      opacity: 0;
      visibility: hidden;
    }
    
    /* Terminal Container */
    .terminal-container {
      padding: 20px;
      height: 100vh;
      overflow-y: auto;
      z-index: 2;
      position: relative;
    }
    
    /* Command Line */
    .command-line {
      display: flex;
      margin-bottom: 10px;
      align-items: center;
    }
    
    .prompt {
      color: var(--primary);
      margin-right: 10px;
      flex-shrink: 0;
    }
    
    .input-line {
      background: transparent;
      border: none;
      color: var(--primary);
      font-family: inherit;
      flex: 1;
      outline: none;
      caret-color: var(--primary);
      font-size: 1rem;
    }
    
    /* Output */
    .output {
      margin-bottom: 15px;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    
    .community-tag {
      color: rgba(0, 255, 0, 0.7);
      font-style: italic;
      margin-left: 10px;
    }
    
    /* Typing Indicator */
    .typing-text {
      display: inline-block;
    }
    
    .typing-cursor {
      display: inline-block;
      background-color: var(--primary);
      width: 2px;
      height: 1em;
      animation: blink 1s infinite;
      margin-left: 1px;
    }
    
    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }
    
    /* Glitch Effect */
    .glitch {
      position: relative;
    }
    
    .glitch::after {
      content: attr(data-text);
      position: absolute;
      left: 2px;
      text-shadow: -2px 0 var(--error);
      top: 0;
      color: var(--primary);
      background: var(--bg);
      overflow: hidden;
      clip-path: polygon(0 0, 100% 0, 100% 30%, 0 30%);
      animation: glitch-anim 5s infinite alternate;
    }
    
    @keyframes glitch-anim {
      0% { clip-path: polygon(0 0, 100% 0, 100% 30%, 0 30%); }
      20% { clip-path: polygon(0 70%, 100% 70%, 100% 100%, 0 100%); }
      40% { clip-path: polygon(0 30%, 100% 30%, 100% 60%, 0 60%); }
      60% { clip-path: polygon(0 50%, 100% 50%, 100% 80%, 0 80%); }
      80% { clip-path: polygon(0 10%, 100% 10%, 100% 40%, 0 40%); }
      100% { clip-path: polygon(0 90%, 100% 90%, 100% 100%, 0 100%); }
    }
    
    /* Floating System Messages */
    .system-message {
      position: absolute;
      color: transparent;
      font-size: clamp(1rem, 3vw, 1.5rem);
      animation: float 15s infinite linear;
      z-index: 1;
      pointer-events: none;
      user-select: none;
      -webkit-text-stroke: 1px rgba(255, 0, 0, 0.3);
      text-stroke: 1px rgba(255, 0, 0, 0.3);
    }
    
    @keyframes float {
      0% { transform: translate(0, 0) rotate(0deg); opacity: 0; }
      10%, 90% { opacity: 0.3; }
      100% { transform: translate(100vw, 100vh) rotate(360deg); opacity: 0; }
    }
    
    /* Divider Line */
    .divider-line {
      position: absolute;
      height: 1px;
      width: 100%;
      background: linear-gradient(90deg, transparent, var(--primary), transparent);
      z-index: 1;
      pointer-events: none;
    }
    
    /* Typing Effect */
    .typing {
      border-right: 2px solid var(--primary);
      animation: blink-caret 0.75s step-end infinite;
    }
    
    @keyframes blink-caret {
      from, to { border-color: transparent; }
      50% { border-color: var(--primary); }
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
      .terminal-container {
        padding: 15px;
      }
      
      .input-line {
        font-size: 0.9rem;
      }
      
      .output {
        font-size: 0.9rem;
      }
    }
    
    @media (max-width: 480px) {
      .terminal-container {
        padding: 10px;
      }
      
      .prompt {
        margin-right: 5px;
      }
    }
    
    /* Accessibility */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
    
    /* Focus indicators */
    .input-line:focus {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }
  </style>
</head>
<body class="crt-effect">
  
  <!-- Background music -->
  <audio id="bgMusic" loop preload="none">
    <source src="sounds/backgroundmusic2.mp3" type="audio/mpeg">
  </audio>
  
  <!-- Entry Animation -->
  <div class="entry-animation" id="entryAnimation">
    <span>ACCESSING PHOENIX INDUSTRIES DATABASE...</span>
  </div>

  <!-- Floating system messages -->
  <div class="system-message" style="top: 10%; left: 5%; animation-delay: 0s;">TOP SECRET</div>
  <div class="system-message" style="top: 30%; left: 70%; animation-delay: 3s;">CLASSIFIED</div>
  <div class="system-message" style="top: 70%; left: 20%; animation-delay: 6s;">RESTRICTED</div>
  <div class="system-message" style="top: 50%; left: 50%; animation-delay: 9s;">EYES ONLY</div>
  <div class="system-message" style="top: 20%; left: 30%; animation-delay: 12s;">REDACTED</div>
  
  <!-- Divider line -->
  <div class="divider-line" style="top: 50%;"></div>

  <div class="terminal-container">
    <div id="output"></div>
    <div class="command-line">
      <span class="prompt">></span>
      <input type="text" class="input-line" id="commandInput" autofocus autocomplete="off" spellcheck="false">
    </div>
  </div>

  <script>
    class SoundGenerator {
      constructor() {
        this.audioContext = null;
        this.initAudioContext();
      }
      
      initAudioContext() {
        try {
          this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
        } catch (e) {
          console.warn('Audio context not supported');
        }
      }
      
      playKeyClickSound() {
        if (!this.audioContext) return;
        
        const oscillator = this.audioContext.createOscillator();
        const gainNode = this.audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(this.audioContext.destination);
        
        // Key click parameters
        oscillator.frequency.setValueAtTime(800, this.audioContext.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(600, this.audioContext.currentTime + 0.1);
        
        gainNode.gain.setValueAtTime(0.1, this.audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + 0.1);
        
        oscillator.type = 'square';
        oscillator.start(this.audioContext.currentTime);
        oscillator.stop(this.audioContext.currentTime + 0.1);
      }
      
      playOutputSound() {
        if (!this.audioContext) return;
        
        const oscillator = this.audioContext.createOscillator();
        const gainNode = this.audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(this.audioContext.destination);
        
        // Shorter and quieter output sound parameters
        oscillator.frequency.setValueAtTime(1000, this.audioContext.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(600, this.audioContext.currentTime + 0.02);
        
        gainNode.gain.setValueAtTime(0.02, this.audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 0.02);
        
        oscillator.type = 'sine';
        oscillator.start(this.audioContext.currentTime);
        oscillator.stop(this.audioContext.currentTime + 0.02);
      }
    }

    class PhoenixTerminal {
      constructor() {
        this.bgMusic = document.getElementById('bgMusic');
        this.entryAnimation = document.getElementById('entryAnimation');
        this.outputElement = document.getElementById('output');
        this.commandInput = document.getElementById('commandInput');
        this.soundGenerator = new SoundGenerator();
        
        this.commandHistory = [];
        this.historyPosition = 0;
        this.currentInput = "";
        this.isTyping = false;
        
        this.documents = {
          "root": ["community.txt", "community-leaders.txt", "drones.txt"],
          
          "community.txt": [
            "Shadow-Keepers.txt",
            "Santa-Maria-Community.txt",
            "The-Crixus.txt",
            "Community-Of-Falcons.txt",
            "The-Enlightened.txt",
            "Querencia-Community.txt",
            "Renacer-Del-Cementerio.txt",
            "55th-Backyard-Regiment.txt",
            "Specters-Of-Sedna.txt"
          ],
          
          "community-leaders.txt": [
            {file: "Maria-Elena-Del-Rosaro.txt", community: "SPECTERS OF SEDNA"},
            {file: "Tom-Crawl-Badford.txt", community: "COMMUNITY OF FALCONS"},
            {file: "Lowell-Johansson.txt", community: "SHADOW KEEPERS"},
            {file: "Brandon-Scott-Redwald.txt", community: "THE CRIXUS"},
            {file: "Diaz-Lopez.txt", community: "QUERENCIA COMMUNITY"},
            {file: "Marcus-Lowrey.txt", community: "55TH BACKYARD REGIMENT"},
            {file: "Ezekiel Valerio.txt", community: "SANTA MARIA COMMUNITY"},
            {file: "Arnold-Alexander-Bolshoy.txt", community: "THE ENLIGHTENED"},
            {file: "Bonnie-Chavez.txt", community: "CEMENTERIO"}
          ],
          
          "drones.txt": [
            "WI-Analysist.txt",
            "WI-Military.txt",
            "WI-Medical.txt"
          ]
        };

        this.fileRedirects = {
          // Community Leaders
          "Maria-Elena-Del-Rosaro.txt": "communityleaders/maria.html",
          "Tom-Crawl-Badford.txt": "communityleaders/tom.html",
          "Lowell-Johansson.txt": "communityleaders/lowel.html",
          "Brandon-Scott-Redwald.txt": "communityleaders/brandon.html",
          "Diaz-Lopez.txt": "communityleaders/diaz.html",
          "Marcus-Lowrey.txt": "communityleaders/marcus.html",
          "Ezekiel Valerio.txt": "communityleaders/ezekiel.html",
          "Arnold-Alexander-Bolshoy.txt": "communityleaders/arnold.html",
          "Bonnie-Chavez.txt": "communityleaders/bonnie.html",
          
          // Community
          "Shadow-Keepers.txt": "community/shadowkeepers.html",
          "Santa-Maria-Community.txt": "community/santamariacommunity.html",
          "The-Crixus.txt": "community/thecrixus.html",
          "Community-Of-Falcons.txt": "community/communityoffalcons.html",
          "The-Enlightened.txt": "community/theenlightened.html",
          "Querencia-Community.txt": "community/querenciacommunity.html",
          "Renacer-Del-Cementerio.txt": "community/renacerdelcementerio.html",
          "55th-Backyard-Regiment.txt": "community/55thbackyardregiment.html",
          "Specters-Of-Sedna.txt": "community/spectersofsedna.html",
          
          // Drones
          "WI-Analysist.txt": "drones/wianalysist.html",
          "WI-Military.txt": "drones/wimilitary.html",
          "WI-Medical.txt": "drones/wimedical.html"
        };
        
        this.init();
      }
      
      init() {
        this.setupAudio();
        this.setupEventListeners();
        this.startEntrySequence();
      }
      
      setupAudio() {
        this.bgMusic.volume = 0.2;
        
        const startMusic = () => {
          this.bgMusic.play().catch(console.warn);
          if (this.soundGenerator.audioContext && this.soundGenerator.audioContext.state === 'suspended') {
            this.soundGenerator.audioContext.resume();
          }
          document.removeEventListener('click', startMusic);
        };
        document.addEventListener('click', startMusic);
      }
      
      setupEventListeners() {
        this.commandInput.addEventListener('keydown', (e) => this.handleKeyDown(e));
        this.commandInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            const command = this.commandInput.value.trim();
            this.commandInput.value = '';
            this.processCommand(command);
          }
        });
        
        // Removed key sound on typing to prevent headaches
        
        // Focus input on click anywhere
        document.addEventListener('click', () => {
          this.commandInput.focus();
        });
      }
      
      startEntrySequence() {
        setTimeout(() => {
          this.entryAnimation.classList.add('fade-out');
          setTimeout(() => {
            this.entryAnimation.style.display = 'none';
            this.typeText("Phoenix Industries Terminal System\nVersion 2.0.7\n\nType help for available commands\n\nNOTE: System files have been damaged, the data you are examining may be corrupted.");
          }, 1000);
        }, 2000);
      }
      
      typeText(text, className = '', callback = null) {
        if (this.isTyping) return;
        this.isTyping = true;
        
        // Disable input during typing
        this.commandInput.disabled = true;
        this.commandInput.placeholder = "Processing...";
        
        const div = document.createElement('div');
        div.className = `output ${className}`;
        
        const textSpan = document.createElement('span');
        textSpan.className = 'typing-text';
        div.appendChild(textSpan);
        
        const cursor = document.createElement('span');
        cursor.className = 'typing-cursor';
        div.appendChild(cursor);
        
        this.outputElement.appendChild(div);
        
        let i = 0;
        const speed = 30; // milliseconds per character
        
        const typeChar = () => {
          if (i < text.length) {
            if (text[i] === '\n') {
              textSpan.innerHTML += '<br>';
            } else {
              // Handle HTML content properly
              const currentHTML = textSpan.innerHTML;
              if (text.substring(i).startsWith('<span class="community-tag">')) {
                // Find the end of the HTML tag
                const endTag = text.indexOf('</span>', i) + 7;
                textSpan.innerHTML = currentHTML + text.substring(i, endTag);
                i = endTag;
              } else {
                textSpan.innerHTML = currentHTML + text[i];
              }
            }
            this.soundGenerator.playOutputSound();
            i++;
            this.outputElement.scrollTop = this.outputElement.scrollHeight;
            setTimeout(typeChar, speed);
          } else {
            cursor.remove();
            this.isTyping = false;
            
            // Re-enable input after typing is done
            this.commandInput.disabled = false;
            this.commandInput.placeholder = "";
            this.commandInput.focus();
            
            if (callback) callback();
          }
        };
        
        typeChar();
      }
      
      handleKeyDown(e) {
        if (e.key === 'Tab') {
          e.preventDefault();
          this.autoComplete();
        } else if (e.key === 'ArrowUp') {
          e.preventDefault();
          if (this.historyPosition < this.commandHistory.length) {
            if (this.historyPosition === 0) {
              this.currentInput = this.commandInput.value;
            }
            this.historyPosition++;
            this.commandInput.value = this.commandHistory[this.commandHistory.length - this.historyPosition] || this.currentInput;
          }
        } else if (e.key === 'ArrowDown') {
          e.preventDefault();
          if (this.historyPosition > 0) {
            this.historyPosition--;
            this.commandInput.value = this.historyPosition === 0 ? this.currentInput : this.commandHistory[this.commandHistory.length - this.historyPosition];
          }
        }
      }
      
      autoComplete() {
        const input = this.commandInput.value.toLowerCase();
        const matches = [];
        
        // Check commands
        const commands = ['help', 'open', 'exit', 'shutdown', 'clear'];
        commands.forEach(cmd => {
          if (cmd.startsWith(input)) matches.push(cmd);
        });
        
        // Check files
        const allFiles = [];
        Object.values(this.documents).flat().forEach(file => {
          const filename = typeof file === 'object' ? file.file : file;
          allFiles.push(filename.toLowerCase());
        });
        
        allFiles.forEach(file => {
          if (file.startsWith(input)) matches.push(file);
        });
        
        if (matches.length === 1) {
          this.commandInput.value = matches[0];
        } else if (matches.length > 1) {
          this.typeText(`Possible completions: ${matches.join(', ')}`);
        }
      }
      
      processCommand(command) {
        if (command === '') return;
        
        this.commandHistory.push(command);
        this.historyPosition = 0;
        this.currentInput = "";
        
        this.addOutput('> ' + command, 'command');
        
        setTimeout(() => {
          switch (true) {
            case command === 'help':
              this.showHelp();
              break;
            case command === 'clear':
              this.clearTerminal();
              break;
            case command === 'exit':
              this.typeText("Terminating current session...", '', () => {
                setTimeout(() => {
                  this.clearTerminal();
                  this.typeText("Phoenix Industries Terminal System\nVersion 2.0.7\n\nType help for available commands");
                }, 1000);
              });
              break;
            case command === 'shutdown':
              this.typeText("Initiating system shutdown...", '', () => {
                setTimeout(() => {
                  window.location.href = 'raiden2.html';
                }, 2000);
              });
              break;
            case command.startsWith('open '):
              const filename = command.substring(5).trim();
              this.openFile(filename);
              break;
            case command === 'open':
              this.typeText("Usage: open [filename]\nExample: open community.txt");
              break;
            case ['community.txt', 'community-leaders.txt', 'drones.txt'].includes(command):
              this.showFileContents(command);
              break;
            default:
              this.typeText("Unknown command. Type help for available commands");
          }
        }, 500);
      }
      
      addOutput(text, className = '') {
        const div = document.createElement('div');
        div.className = `output ${className}`;
        div.innerHTML = text;
        this.outputElement.appendChild(div);
        this.outputElement.scrollTop = this.outputElement.scrollHeight;
      }
      
      showHelp() {
        const helpText = [
          "Available commands:",
          "community.txt - Show community files",
          "community-leaders.txt - Show community leader files",
          "drones.txt - Show drone files",
          "open [filename] - Open the specified file",
          "clear - Clear the terminal",
          "exit - Return to main menu",
          "shutdown - Shutdown the system",
          "help - Show this help message",
          "",
          "NOTE: System files have been damaged, the data you are examining may be corrupted."
        ].join('\n');
        
        this.typeText(helpText);
      }
      
      showFileContents(file) {
        if (this.documents[file]) {
          this.clearTerminal();
          
          const fileList = this.documents[file].map(item => {
            if (typeof item === 'object') {
              return item.file + (item.community ? ` <span class="community-tag">${item.community}</span>` : '');
            }
            return item;
          }).join('\n');
          
          this.typeText(file + " contents:\n", 'glitch', () => {
            setTimeout(() => {
              this.typeText(fileList, 'glitch', () => {
                setTimeout(() => {
                  this.typeText("\n\nUse 'open [filename]' to access files");
                }, 500);
              });
            }, 500);
          });
        } else {
          this.typeText("File not found: " + file);
        }
      }
      
      openFile(filename) {
        // Check if it's a category file
        if (['community.txt', 'community-leaders.txt', 'drones.txt'].includes(filename)) {
          this.showFileContents(filename);
          return;
        }
        
        // Find the file in redirects (case insensitive)
        let foundFile = null;
        for (const [key, value] of Object.entries(this.fileRedirects)) {
          if (key.toLowerCase() === filename.toLowerCase()) {
            foundFile = key;
            break;
          }
        }
        
        if (foundFile) {
          // Find community tag if it's a leader file
          let communityTag = '';
          for (const leader of this.documents['community-leaders.txt']) {
            if (leader.file.toLowerCase() === filename.toLowerCase()) {
              communityTag = leader.community;
              break;
            }
          }
          
          const openingText = communityTag ? 
            `Opening ${foundFile} <span class="community-tag">${communityTag}</span>` :
            `Opening ${foundFile}`;
          
          this.typeText(openingText, 'glitch', () => {
            setTimeout(() => {
              window.location.href = this.fileRedirects[foundFile];
            }, 1500);
          });
        } else {
          this.typeText(`File not found: ${filename}\n\nTry one of these:\n`, 'glitch', () => {
            // Show suggestions
            const suggestions = [];
            for (const key in this.fileRedirects) {
              if (key.toLowerCase().includes(filename.toLowerCase())) {
                suggestions.push(key);
                if (suggestions.length >= 5) break;
              }
            }
            
            setTimeout(() => {
              if (suggestions.length > 0) {
                this.typeText(suggestions.join('\n'));
              } else {
                this.typeText("No similar files found.");
              }
            }, 500);
          });
        }
      }
      
      clearTerminal() {
        this.outputElement.innerHTML = '';
      }
    }
    
    // Initialize terminal when DOM is loaded
    document.addEventListener('DOMContentLoaded', () => {
      new PhoenixTerminal();
    });
  </script>
</body>
</html>